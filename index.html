<?xml version='1.0' encoding='UTF-8'?>
<link href="/css/github-css.css" rel="stylesheet"/>
<meta charset="utf-8" content="text/html"/>
<div class="gist">
<!-- Dark mode because yes - nocturn9x -->
<script type="text/javascript" src="https://phseiff.com/darkreader/darkreader.js"></script><script>DarkReader.setFetchMethod(window.fetch); DarkReader.auto({brightness: 100,contrast: 90, sepia: 10});</script>
<style class="formula-style">
        svg.gh-md-to-html-formula {
            fill: black;
        }
    </style>
<div class="gist-file"> <!-- This is the class that is responsible for the boxing! -->
<div class="gist-data">
<div class="js-gist-file-update-container js-task-list-container file-box">
<div class="file" id="article-index">
<div class="Box-body readme blob js-code-block-container p-5 p-xl-6" id="file-docker-image-pull-md-readme" style="margin-left: 40px; margin-right: 40px; margin-top: 20px; margin-bottom: 20px">
<article class="markdown-body entry-content container-lg" itemprop="text">
<h1>
<a aria-hidden="true" class="anchor" href="#japl---just-another-programming-language" id="user-content-japl---just-another-programming-language"><span aria-hidden="true" class="octicon octicon-link"></span></a>JAPL - Just Another Programming Language</h1>
<p>JAPL is an interpreted, dynamically-typed, garbage-collected, and minimalistic programming language with C- and Java-like syntax.</p>
<h2>
<a aria-hidden="true" class="anchor" href="#j-what" id="user-content-j-what"><span aria-hidden="true" class="octicon octicon-link"></span></a>J.. what?</h2>
<p>You may wonder what's the meaning of JAPL: well, it turns out to be an acronym for <strong>Just Another Programming Language</strong>, but beware! Despite the name, the pronunciation is the same as "JPL".</p>
<h3>
<a aria-hidden="true" class="anchor" href="#disclaimer" id="user-content-disclaimer"><span aria-hidden="true" class="octicon octicon-link"></span></a>Disclaimer</h3>
<p>This project is currently a WIP (Work in Progress) and is not optimized nor complete.
The design of the language may change at any moment and all the source inside this repo is alpha code quality, for now.</p>
<p>For other useful information, check the LICENSE file in this repo.</p>
<p>JAPL is licensed under the Apache 2.0 license.</p>
<h3>
<a aria-hidden="true" class="anchor" href="#project-roadmap" id="user-content-project-roadmap"><span aria-hidden="true" class="octicon octicon-link"></span></a>Project roadmap</h3>
<p>In no particular order, here's a list that is constantly updated and that helps us to keep track
of what's done in JAPL:</p>
<ul>
<li>[x] Parsing/Lexing</li>
<li>[x] Type system (string, integer, float)</li>
<li>[ ] Builtin collections (arraylist, mapping, tuple, set)</li>
<li>[x] Builtin functions (<code>print</code>, etc)</li>
<li>[ ] An import system</li>
<li>[x] Control flow (if/else)</li>
<li>[x] Loops (for/while)</li>
<li>[x] Comparisons operators (<code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>==</code>)</li>
<li>[x] Casting with the <code>as</code> operator</li>
<li>[x] Modulo division (<code>%</code>) and exponentiation (<code>**</code>)</li>
<li>[x] Bitwise operators (AND, OR, XOR, NOT)</li>
<li>[x] Simple optimizations (constant string interning, singletons caching)</li>
<li>[ ] Garbage collector (Mark &amp; Sweep)</li>
<li>[x] Operations on strings (addition, multiplication -&gt; TODO both sides)</li>
<li>[x] Functions</li>
<li>[ ] Closures</li>
<li>[ ] Functions default and keyword arguments</li>
<li>[ ] An OOP system (class-based)</li>
<li>[x] Global and local variables</li>
<li>[x] Explicit scopes using bracket</li>
<li>[ ] Native asynchronous (<code>await</code>/<code>async fun</code>) support</li>
<li>[ ] Bytecode optimizations such as constant folding and stack caching</li>
<li>[x] Lambda functions as inline expressions</li>
<li>[ ] Arbitrary-precision arithmetic</li>
<li>[x] Multi-line comments <code>/* like this */</code> (can be nested)</li>
<li>[ ] Generators</li>
<li>[ ] A standard library</li>
<li>[x] String slicing, with start:end syntax as well</li>
<li>[ ] Multithreading and multiprocessing support with a global VM Lock like CPython</li>
<li>[ ] Exceptions</li>
<li>[x] Logical operators (<code>not</code>, <code>or</code>, <code>and</code>, <code>is</code>)</li>
<li>[x] Basic arithmetic (<code>+</code>, <code>-</code>, <code>/</code>, <code>*</code>)</li>
<li>[ ] Optional JIT Compilation</li>
<li>[ ] Static type checker (compiler module)</li>
<li>[ ] Runtime Type Checking</li>
<li>[x] 0-argument functions without ()</li>
</ul>
<h2>
<a aria-hidden="true" class="anchor" href="#contributing" id="user-content-contributing"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contributing</h2>
<p>If you want to contribute, feel free to open a PR!</p>
<p>To get started, you might want to have a look at the currently open issues and start from there</p>
<h3>
<a aria-hidden="true" class="anchor" href="#community" id="user-content-community"><span aria-hidden="true" class="octicon octicon-link"></span></a>Community</h3>
<p>Our first goal is to create a welcoming and helpful community, so if you are so inclined, you might want to join our <a href="https://discord.gg/P8FYZvM" rel="nofollow">Discord server</a> and our <a href="https://forum.japl-lang.com" rel="nofollow">forum</a>! We can't wait to welcome you into our community :D</p>
<h3>
<a aria-hidden="true" class="anchor" href="#a-special-thanks" id="user-content-a-special-thanks"><span aria-hidden="true" class="octicon octicon-link"></span></a>A special thanks</h3>
<p>JAPL is born thanks to the amazing work of Bob Nystrom that wrote a book available completely for free at <a href="https://craftinginterpreters.com" rel="nofollow">this</a> link, where he describes the implementation of a simple language called Lox</p>
<h2>
<a aria-hidden="true" class="anchor" href="#japl---installing" id="user-content-japl---installing"><span aria-hidden="true" class="octicon octicon-link"></span></a>JAPL - Installing</h2>
<p>JAPL is currently in its early stages and is therefore in a state of high mutability, so this installation guide might
not be always up to date</p>
<h3>
<a aria-hidden="true" class="anchor" href="#requirements" id="user-content-requirements"><span aria-hidden="true" class="octicon octicon-link"></span></a>Requirements</h3>
<p>To compile JAPL, you need the following:</p>
<ul>
<li>Nim &gt;= 1.2 installed on your system</li>
<li>Git (to clone the repository)</li>
<li>Python &gt;= 3.6 (Build script)</li>
</ul>
<h3>
<a aria-hidden="true" class="anchor" href="#cloning-the-repo" id="user-content-cloning-the-repo"><span aria-hidden="true" class="octicon octicon-link"></span></a>Cloning the repo</h3>
<p>Once you've installed all the required tooling, you can clone the repo with the following command</p>
<div class="highlight highlight-source-shell"><pre>git clone https://github.com/japl-lang/japl</pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#running-the-build-script" id="user-content-running-the-build-script"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running the build script</h3>
<p>As a next step, you need to run JABT (YES, Just Another Build Tool). This will generate the required configuration files, compile the JAPL runtime and run tests (unless <code>--skip-tests</code> is used). There are some settings that can be tweaked with command-line options (or environment variables), for more information, run <code>python3 build.py --help</code>.</p>
<p>To compile the JAPL runtime, you'll first need to move into the project's directory you cloned before, so run <code>cd japl</code>, then <code>python3 build.py ./src</code> and wait for it to complete. You should now find an executable named <code>japl</code> (or <code>japl.exe</code> on windows) inside the <code>src</code> folder.</p>
<p>If you're running under windows, you might encounter some issues when using forward-slashes as opposed to back-slashes in paths, so you should replace <code>./src</code> with <code>.\src</code></p>
<p>If you're running under linux, you can also call the build script with <code>./build.py</code> (assuming python is installed in the directory indicated by the shebang at the top of the file)</p>
<h3>
<a aria-hidden="true" class="anchor" href="#advanced-builds" id="user-content-advanced-builds"><span aria-hidden="true" class="octicon octicon-link"></span></a>Advanced builds</h3>
<p>If you need more customizability or want to enable debugging for JAPL, there's a few things you can do.</p>
<h3>
<a aria-hidden="true" class="anchor" href="#nim-compiler-options" id="user-content-nim-compiler-options"><span aria-hidden="true" class="octicon octicon-link"></span></a>Nim compiler options</h3>
<p>The build tool calls the system's nim compiler to build JAPL. If you want to customize the options passed to the compiler, you can pass a comma separated list of key:value pairs (spaces not allowed) via the <code>--flags</code> option. For example, doing <code>python3 build.py src --flags d:release,threads:on</code> will call <code>nim compile src/japl -d:release --threads:on</code>.</p>
<h4>
<a aria-hidden="true" class="anchor" href="#known-issues" id="user-content-known-issues"><span aria-hidden="true" class="octicon octicon-link"></span></a>Known issues</h4>
<p>Right now JAPL is in its very early stages and we've encountered a series of issues related to nim's garbage collection implementations. Some of them
seem to clash with JAPL's own memory management and cause random <code>NilAccessDefect</code>s because the GC frees stuff that JAPL needs. If the test suite shows
weird crashes try changing (via <code>--flags</code>) the <code>gc</code> option to <code>boehm</code> (particularly recommended since it seems to cause very little interference with JAPL), or <code>regions</code> to see if this mitigates the problem; this is a temporary solution until the JAPL VM becomes fully independent from nim's runtime memory management.</p>
<h3>
<a aria-hidden="true" class="anchor" href="#japl-debugging-options" id="user-content-japl-debugging-options"><span aria-hidden="true" class="octicon octicon-link"></span></a>JAPL Debugging options</h3>
<p>JAPL has some (still very beta) internal tooling to debug various parts of its ecosystem (compiler, runtime, GC, etc).
There are also some compile-time constants (such as the heap grow factor for the garbage collector) that can be set via the <code>--options</code> parameter in the same fashion as the nim's compiler options. The available options are:</p>
<ul>
<li>
<code>debug_vm</code> -&gt; Debugs the runtime, instruction by instruction, showing the effects of the bytecode on the VM's stack and scopes in real time (beware of bugs!)</li>
<li>
<code>debug_gc</code> -&gt; Debugs the garbage collector (once we have one)</li>
<li>
<code>debug_alloc</code> -&gt; Debugs memory allocation/deallocation</li>
<li>
<code>debug_compiler</code> -&gt; Debugs the compiler, showing each byte that is spit into the bytecode</li>
<li>
<code>skip_stdlib_init</code> -&gt; Skips the initialization of the standard library (useful to reduce the amount of unneeded output in debug logs)</li>
<li>
<code>array_grow_factor</code> -&gt; Sets the multiplicative factor by which JAPL's dynamic array implementation will increase its size when it becomes full</li>
<li>
<code>map_load_factor</code> -&gt; A real value between 0 and 1 that indicates the max. % of full buckets in JAPL's hashmap implementation that are needed to trigger a resize</li>
<li>
<code>frames_max</code> - The max. number of call frames allowed, used to limit recursion depth</li>
</ul>
<p>Each of these options is independent of the others and can be enabled/disabled at will. Except for <code>array_grow_factor</code>, <code>map_load_factor</code> and <code>frames_max</code> (which take integers and a real value respectively), all other options require boolean parameters; to enable an option, pass <code>option_name:true</code> to <code>--options</code> while to disable it, replace <code>true</code> with <code>false</code>.</p>
<p>Note that the build tool will generate a file named <code>config.nim</code> inside the <code>src</code> directory and will use that for subsequent builds, so if you want to override it you'll have to enable <code>--override-config</code> (via CLI, env. variables or build profiles). Passing it without any other option will fallback to (somewhat) sensible defaults</p>
<p><strong>P.S.</strong>: For now the test suite assumes that all debugging options are turned off, so for development/debug builds we recommend skipping the test suite by passing <code>--skip-tests</code> to the build script. This will be fixed soon (the test suite will ignore debugging output)</p>
<h3>
<a aria-hidden="true" class="anchor" href="#installing-on-linux" id="user-content-installing-on-linux"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installing on Linux</h3>
<p>If you're on linux and can't stand the fact of having to call japl with <code>./src/japl</code>, we have some good news! The build script can
optionally move the compiled binary in the first writeable entry inside your PATH so that you can just type <code>jpl</code> inside your terminal
to open the REPL. To avoid issues, this option is disabled by default and must be turned on by passing <code>--install</code>, but note that
if in <em>any</em> directory listed in PATH there is either a file or a folder named <code>jpl</code> the build script will complain about it and refuse to overwrite
the already existing data unless <code>--ignore-binary</code> is passed!</p>
<h3>
<a aria-hidden="true" class="anchor" href="#environment-variables" id="user-content-environment-variables"><span aria-hidden="true" class="octicon octicon-link"></span></a>Environment variables</h3>
<p>On both Windows and Linux, the build script supports reading parameters from environment variables if they are not specified via the command line.
All options follow the same naming scheme: <code>JAPL_OPTION_NAME=value</code> and will only be applied if no explicit override for them is passed
when running the script</p>
<h3>
<a aria-hidden="true" class="anchor" href="#build-profiles" id="user-content-build-profiles"><span aria-hidden="true" class="octicon octicon-link"></span></a>Build profiles</h3>
<p>JABT comes with a handy <code>--profile</code> option that allows to pass a JSON file with
all the build arguments and flags. The JAPL toolsuite comes with some build profiles by default, they are
found inside the <code>resources/profiles</code> directory and are particularly useful to replicate common build options.
Note that profiles have priority over command-line options and environment variables!</p>
</article>
</div>
</div>
</div>
</div>
</div>
</div>
